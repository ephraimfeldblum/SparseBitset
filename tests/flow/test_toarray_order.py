from RLTest import Env


def test_toarray_order(env: Env):
    env.cmd("BITS.INSERT", "arr", 100, 1, 50)
    expected = [1, 50, 100]
    env.assertEqual(env.cmd("BITS.TOARRAY", "arr"), expected)

    env.cmd("BITS.REMOVE", "arr", 50)
    env.assertEqual(env.cmd("BITS.TOARRAY", "arr"), [1, 100])


def test_toarray_order_large(env: Env):
    env.cmd("DEL", "larg")
    vals = [
        1000, 10, 500, 250, 999, 0, 750, 333, 666, 123, 456, 789, 234, 345, 890, 432, 321, 111, 222, 444, 555, 534,
        777, 888, 9999, 8888, 7777, 6666, 5555, 4444, 3333, 8901, 9012, 10000, 15000, 20000, 25000, 30000, 35000,
        23234, 24234, 25234, 26234, 27234, 28234, 29234, 30234, 31234, 32234, 33234, 34234, 35234, 36234, 37234,
        38234, 39234, 7135, 8246, 10234, 11234, 12234, 13234, 14234, 15234, 16234, 17234, 18234, 19234, 20234, 5284,
        21234, 22234, 2222, 1111, 1234, 2345, 3456, 4567, 5678, 6789, 7890, 1357, 2468, 3690, 1470, 2580, 3691, 6846,
        4802, 5913, 6024, 9357, 10468, 11579, 12680, 13791, 14802, 15913, 16024, 17135, 18246, 19357, 20468, 21579,
        22680, 23791, 24802, 25913, 27024, 28135, 29246, 30357, 31468, 32579, 33680, 34791, 35802, 36913, 37024, 26489,
        254035, 123456, 234567, 345678, 456789, 567890, 678901, 789012, 890123, 901234, 634610, 745721, 856832, 967943,
    ]
    env.cmd("BITS.INSERT", "larg", *vals)
    expected = sorted(vals)
    env.assertEqual(env.cmd("BITS.TOARRAY", "larg"), expected)
